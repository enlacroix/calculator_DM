# Комбинаторика, лекции 6-8
# Оглавление

1. [Формула Стирлинга](##Формула-Стирлинга)
2. [Введение в комбинаторику. Биноминальные коэффициенты](#Введение-в-комбинаторику.-Биноминальные-коэффициенты)

   
## Формула Стирлинга
$$\boxed{
n! \approx \frac{\sqrt{2\pi n} \cdot n^n}{e^n}
}$$
Формула Стирлинга не дает точное значение факториала, но гарантирует, что предел отношения левой и правой части при $n \rightarrow \infty$ равен 1.  
Формула с поправкой Рамануджана:
$$n! \approx \sqrt{\pi} \cdot \left(\frac{n}{e}\right)^n \cdot \sqrt[6]{8n^3+4n^2+n}$$
**Задача на формулу Стирлинга**: Найти чему приблизительно равно выражение $C_{2n}^n$.  
$$C_{2n}^n = \frac{(2n)!}{n! \cdot n!} \sim \frac{(\frac{2n}{e})^{2n} \cdot \sqrt{2\pi \cdot 2 n}}{(\frac{n}{e})^{2n} \cdot 2\pi n} = \frac{2^{2n}}{\sqrt{\pi n}}$$
(при $n = 1000$ отношение полученного выражения к исходному равно 0,999622) 

## Введение в комбинаторику. Биноминальные коэффициенты

**Основные формулы**
$$C_{n}^{k}= \frac{n!}{k!(n-k)!}$$
$$C_{n}^{ m}=C_{n-1}^{ m-1}+C_{n-1}^{ m}$$
$$(a+b)^{n}=\sum_{k=0}^{n} C_{n}^{k} a^{n-k} b^{k}$$
$$2^n = \sum_{k=0}^{n} C_{n}^{k}$$
$$\sum_{k=0}^{n} (-1)^k C_{n}^{k} = 0 $$
Доказательство нижней формулы. Перемножим $(1+x)^n \cdot (1+x)^n$. Коэффициент перед $x^n$ равен правой части. Из  разложения по биному $(1+x)^{2n}$ понимаем, что это $C_{2n}^n$.
$$C_{2 n}^{n}=\left(C_{n}^{0}\right)^{2}+\left(C_{n}^{1}\right)^{2}+\ldots+\left(C_{n}^{n}\right)^{2}$$

**Число путей в прямоугольнике** $n \times m$ равно $C_{n+m}^{n}=C_{n+m}^{m}$.  
Чтобы добраться из левого нижнего угла в правый верхний нам нужно сделать $n$ шагов по горизонтали и $m$ шагов по вертикали, следовательно, общая длина пути всегда равна $m+n$ (в примере выше длина пути была равна 5).  
Мы можем интерпретировать это следующим образом: возьмем на клетчатой бумаге прямолинейный отрезок длиной $m+n$ и отметим на нем $n$ клеточек. Отмеченные клеточки будут горизонтальными участками пути, а не отмеченные - вертикальными. Число способов отметить на отрезке $n$ клеточек из $n+m$ равно $C_{n+m}^{n}$.  

**Число путей в кубе** из точки (0, 0, 0) в $(x, y, z)$ это $C^y_{x+y+z} \cdot C^z_{x+z}$. Из аналогичных соображений, что и в прямоугольнике: перемещения по трем координатам укладываются в одну прямую, где нужно выбрать перемещение по одной координате, затем из оставшихся отрезков перемещение по второй, третья задается автоматически.

## Определение коэффициента в биноминальном разложении*

### Пример 1.
$$(x+y)^{7}=\underbrace{(x+y)(x+y)(x+y)(x+y)(x+y)(x+y)(x+y)}_{\text {семь раз }}=\ldots+? x^{3} y^{4}+\ldots$$

Чему равен коэффициент при $x^{3} y^{4}$? Для этого мы должны раскрыть скобки в произведении и посмотреть, сколько раз встречается слагаемое $x^{3} y^{4}$. Каким образом такое слагаемое возникает? Для этого мы должны в трех скобках взять $x$, а в оставшихся - $y$, и перемножить, т.е. мы должны выбрать три скобки из семи, где мы в произведение берем $x$. Но это можно сделать $\binom{7}{3}=\binom{7}{4}=35$ способами.

### Пример 2.
Найти коэффициент перед $x^6$ в разложении $(1-2x+2x^4)^6$.

Пусть $a = 1, b = 2x^4 - 2x = 2x(x^3-1)$. Тогда:

$$(1-2x+2x^4)^6 = C_{6}^{0}1^6(2x^4-2x)^0 + C_{6}^{1}1^5(2x)^1(x^3-1)^1 + C_{6}^{2}(2x)^2(x^3-1)^2$$
$$ + C_{6}^{3}(2x)^3(x^3-1)^3 +  C_{6}^{4}(2x)^4(x^3-1)^4 + C_{6}^{5}(2x)^5(x^3-1)^5 + (2x)^6(x^3-1)^6$$

Ищем слагаемые, которые могут дать $x^6$. Рассмотрим четвертое слагаемое $C_{6}^{3}(2x)^3(x^3-1)^3$. $(x^3-1)^3$ дают $x$ в степенях 9, 6, 3, 0. Перемножая с $8x^3$, мы устанавливаем, что нас интересует коэффициент перед $x^3$. Он будет равен $C_{3}^{1}(-1)^2 = 3.$ Тогда вклад от третьего слагаемого будет равен $C_{6}^{3} \cdot 8 \cdot 3 = 480.$ Также нас интересует шестое слагаемое, коэффициент перед $x^6$ будет равен $2^6(-1)^6 = 64.$ Итого, коэффициент перед $x^6$ будет равен $480 + 64 = 544.$

### Пример 3.
Найти коэффициент при $x^{8}$ в разложении $\left(1- x +2x^{3}\right)^{7}$.

$(a+b+c)^7, a = 1, b = -x, c = 2x^3$. Установим, какие слагаемые нужно взять, чтобы получить восьмую степень. Во-первых, поймем, что $c$ может принимать только значения 1 или 2. (0 не подходит, так как максимальная степень будет равна 7, 3 степень и выше - перебор). Тогда возможны два случая (сумма степеней равна 7, $x$ будет в восьмой степени): 
$$a^1b^5c^1 \ a^3b^2c^2$$

Обращаем внимание на знаки и изначальные коэффициенты, возводим их также в степень:

$$\frac{7!}{1!5!1!} \cdot (1)^1 (-1)^5 (2)^1 + \frac{7!}{3!2!2!} \cdot (1)^3 (-1)^2 (2)^2 = 7\cdot6\cdot5\cdot4 - 7\cdot6\cdot2 = 7\cdot6\cdot18 = 756$$

### Пример 4.
Найти максимальный коэффициент в разложении $\left(x+y+z+u\right)^{7}$.

Исходя из общей формулы для коэффициента нужно так подобрать степени $x, y, z, u$, чтобы знаменатель был минимален. Тогда максимальный коэффициент:
$\frac{7!}{2!2!2!1!}$



