# Комбинаторика, лекции 6-8

## Формула Стирлинга(4)
$$\boxed{
n! \approx \frac{\sqrt{2\pi n} \cdot n^n}{e^n}
}$$
Формула Стирлинга не дает точное значение факториала, но гарантирует, что предел отношения левой и правой части при $n \rightarrow \infty$ равен 1.  
Формула с поправкой Рамануджана:
$$n! \approx \sqrt{\pi} \cdot \left(\frac{n}{e}\right)^n \cdot \sqrt[6]{8n^3+4n^2+n}$$
**Задача на формулу Стирлинга**: Найти чему приблизительно равно выражение $C_{2n}^n$.  
$$C_{2n}^n = \frac{(2n)!}{n! \cdot n!} \sim \frac{(\frac{2n}{e})^{2n} \cdot \sqrt{2\pi \cdot 2 n}}{(\frac{n}{e})^{2n} \cdot 2\pi n} = \frac{2^{2n}}{\sqrt{\pi n}}$$
(при $n = 1000$ отношение полученного выражения к исходному равно 0,999622) 

## Введение в комбинаторику. Биноминальные коэффициенты

**Основные формулы**
$$C_{n}^{k}= \frac{n!}{k!(n-k)!}$$
$$C_{n}^{ m}=C_{n-1}^{ m-1}+C_{n-1}^{ m}$$
$$(a+b)^{n}=\sum_{k=0}^{n} C_{n}^{k} a^{n-k} b^{k}$$
$$2^n = \sum_{k=0}^{n} C_{n}^{k}$$
$$\sum_{k=0}^{n} (-1)^k C_{n}^{k} = 0 $$
Доказательство нижней формулы. Перемножим $(1+x)^n \cdot (1+x)^n$. Коэффициент перед $x^n$ равен правой части. Из  разложения по биному $(1+x)^{2n}$ понимаем, что это $C_{2n}^n$.
$$C_{2 n}^{n}=\left(C_{n}^{0}\right)^{2}+\left(C_{n}^{1}\right)^{2}+\ldots+\left(C_{n}^{n}\right)^{2}$$

**Число путей в прямоугольнике** $n \times m$ равно $C_{n+m}^{n}=C_{n+m}^{m}$.  
Чтобы добраться из левого нижнего угла в правый верхний нам нужно сделать $n$ шагов по горизонтали и $m$ шагов по вертикали, следовательно, общая длина пути всегда равна $m+n$ (в примере выше длина пути была равна 5).  
Мы можем интерпретировать это следующим образом: возьмем на клетчатой бумаге прямолинейный отрезок длиной $m+n$ и отметим на нем $n$ клеточек. Отмеченные клеточки будут горизонтальными участками пути, а не отмеченные - вертикальными. Число способов отметить на отрезке $n$ клеточек из $n+m$ равно $C_{n+m}^{n}$.  

**Число путей в кубе** из точки (0, 0, 0) в $(x, y, z)$ это $C^y_{x+y+z} \cdot C^z_{x+z}$. Из аналогичных соображений, что и в прямоугольнике: перемещения по трем координатам укладываются в одну прямую, где нужно выбрать перемещение по одной координате, затем из оставшихся отрезков перемещение по второй, третья задается автоматически.




